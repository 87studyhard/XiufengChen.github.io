<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Reactjs学习笔记（二） - Xiufeng</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="START UP A REACT PROJECTSetting up package.jsonCreate a new one using npm init command, selecting defaults where uncertain./package.json123456789101112&amp;#123;	&quot;name&quot;: &quot;react-speed-coding-code&quot;,	&quot;versi">
<meta property="og:type" content="article">
<meta property="og:title" content="Reactjs学习笔记（二）">
<meta property="og:url" content="http://xiufengchen.github.io/2016/07/07/Learning-Reactjs-2/index.html">
<meta property="og:site_name" content="Xiufeng">
<meta property="og:description" content="START UP A REACT PROJECTSetting up package.jsonCreate a new one using npm init command, selecting defaults where uncertain./package.json123456789101112&amp;#123;	&quot;name&quot;: &quot;react-speed-coding-code&quot;,	&quot;versi">
<meta property="og:image" content="http://i.imgur.com/5pHysd7.jpg?1">
<meta property="og:updated_time" content="2016-09-06T17:56:20.457Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Reactjs学习笔记（二）">
<meta name="twitter:description" content="START UP A REACT PROJECTSetting up package.jsonCreate a new one using npm init command, selecting defaults where uncertain./package.json123456789101112&amp;#123;	&quot;name&quot;: &quot;react-speed-coding-code&quot;,	&quot;versi">
<meta name="twitter:image" content="http://i.imgur.com/5pHysd7.jpg?1">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-65933410-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
      <a id="logo" class="logo logo-text" href="/">Xiufeng</a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
          <a class="main-nav-link" href="/atom.xml">Rss</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://xiufengchen.github.io"></form>
        </div>
      </nav>
    </div>
  </div>
</header>
    <section id="main" class="outer"><article id="post-Learning-Reactjs-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Reactjs学习笔记（二）
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/07/07/Learning-Reactjs-2/" class="article-date">
  <time datetime="2016-07-07T23:01:59.000Z" itemprop="datePublished">2016-07-07</time>
</a>
      
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="http://i.imgur.com/5pHysd7.jpg?1" alt="Learning Reactjs 2"></p>
<h2 id="START-UP-A-REACT-PROJECT"><a href="#START-UP-A-REACT-PROJECT" class="headerlink" title="START UP A REACT PROJECT"></a>START UP A REACT PROJECT</h2><h3 id="Setting-up-package-json"><a href="#Setting-up-package-json" class="headerlink" title="Setting up package.json"></a>Setting up package.json</h3><p>Create a new one using npm init command, selecting defaults where uncertain.<br><strong>/package.json</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">	<span class="string">"name"</span>: <span class="string">"react-speed-coding-code"</span>,</div><div class="line">	<span class="string">"version"</span>: <span class="string">"1.0.0"</span>,</div><div class="line">	<span class="string">"description"</span>: <span class="string">"Companion code for React Speed Coding book"</span>,</div><div class="line">	<span class="string">"main"</span>: <span class="string">"index.js"</span>,</div><div class="line">	<span class="string">"private"</span>: <span class="literal">true</span>,</div><div class="line">	<span class="string">"scripts"</span>: &#123;</div><div class="line">		<span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></div><div class="line">	&#125;,</div><div class="line">	<span class="string">"author"</span>: <span class="string">"Manav Sehgal"</span>,</div><div class="line">	<span class="string">"license"</span>: <span class="string">"MIT"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<h3 id="Installing-Starter-Dependencies"><a href="#Installing-Starter-Dependencies" class="headerlink" title="Installing Starter Dependencies"></a>Installing Starter Dependencies</h3><p><strong>Install React dependencies</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm install --save react</div><div class="line">npm install --save react-dom</div></pre></td></tr></table></figure></p>
<p><strong>Install Webpack dependencies</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev webpack</div><div class="line">npm install --save-dev webpack-dev-server</div></pre></td></tr></table></figure></p>
<p>You can add functionality to Webpack using plugins. We will use automatic HTML generation plugins for creating index.html for your app.<br><strong>Install Webpack plugins</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev html-webpack-plugin</div><div class="line">npm install --save-dev html-webpack-template</div></pre></td></tr></table></figure></p>
<p>Webpack requires loaders to process specific file types.<br><strong>Install Webpack loaders</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev css-loader</div><div class="line">npm install --save-dev style-loader</div></pre></td></tr></table></figure></p>
<ol>
<li>Babel compiles React JSX and ES6 to ES5 JavaScript. We need babel-loader as Webpack Babel loader for JSX file types.</li>
<li>Hot loading using babel-preset-react-hmre makes your browser update automatically when there are changes to code, without losing current state of your app.</li>
<li>ES6 support requires babel-preset-es2015 Babel preset.<br><strong>Install Babel dependencies</strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev babel-core</div><div class="line">npm install --save-dev babel-loader</div><div class="line">npm install --save-dev babel-preset-es2015</div><div class="line">npm install --save-dev babel-preset-react</div><div class="line">npm install --save-dev babel-preset-react-hmre</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Configuring-Babel"><a href="#Configuring-Babel" class="headerlink" title="Configuring Babel"></a>Configuring Babel</h3><p>Babel configuration is specified in .babelrc file. React Hot Loading is required only during development.<br><strong> /.babelrc </strong><br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">	<span class="attr">"presets"</span>: [<span class="string">"react"</span>, <span class="string">"es2015"</span>],</div><div class="line">	<span class="attr">"env"</span>: &#123;</div><div class="line">		<span class="attr">"development"</span>: &#123;</div><div class="line">			<span class="attr">"presets"</span>: [<span class="string">"react-hmre"</span>]</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="Creating-Webpack-configuration"><a href="#Creating-Webpack-configuration" class="headerlink" title="Creating Webpack configuration"></a>Creating Webpack configuration</h3><ol>
<li>To start off, you need to initialize the config file with dependencies. There are only two in case of development config, webpack and HTML generation plugin.</li>
<li><p>Next we initialize the APP, BUILD, and STYLE paths. We also configure defaults for our HOST and PORT.<br><strong>/webpack.config.js initialization</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line">   <span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</div><div class="line">   <span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"></div><div class="line">   <span class="keyword">const</span> APP = path.join(__dirname, <span class="string">'/app'</span>);</div><div class="line">   <span class="keyword">const</span> BUILD = path.join(__dirname, <span class="string">'/build'</span>;</div><div class="line">   <span class="keyword">const</span> STYLE = path.join(__dirname, <span class="string">'/app/style.css'</span>;</div><div class="line"><span class="keyword">const</span> HOST = process.env.HOST || <span class="string">'localhost'</span>;</div><div class="line"><span class="keyword">const</span> PORT = process.env.PORT || <span class="number">8080</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>Next section defines your app entry, output, and extensions.<br><strong>/webpack.config.js paths and extensions</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">	entry: &#123;</div><div class="line">		app: APP,</div><div class="line">		style: STYLE</div><div class="line">	&#125;,</div><div class="line">	output: &#123;</div><div class="line">		path: BUILD,</div><div class="line">		filename: <span class="string">'[name].js'</span></div><div class="line">	&#125;,</div><div class="line">	resolve: &#123;</div><div class="line">		extensions: [<span class="string">''</span>, <span class="string">'.js'</span>, <span class="string">'.jsx'</span>]</div><div class="line">	&#125;,</div></pre></td></tr></table></figure>
</li>
<li><p>We follow this by defining the loaders for processing various file types used within our app.<br><strong>/webpack.config.js loaders</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>: &#123;</div><div class="line">	loaders: [</div><div class="line">		&#123;</div><div class="line">			test: <span class="regexp">/\.jsx?$/</span>,</div><div class="line">			loaders: [<span class="string">'babel?cacheDirectory'</span>],</div><div class="line">			include: APP</div><div class="line">		&#125;,</div><div class="line">		&#123;</div><div class="line">			test: <span class="regexp">/\.css$/</span>,</div><div class="line">			loaders: [<span class="string">'style'</span>, <span class="string">'css'</span>],</div><div class="line">			include: APP</div><div class="line">		&#125;</div><div class="line">	]</div><div class="line">&#125;,</div></pre></td></tr></table></figure>
</li>
<li><p>Now that we have loaders configured, let us add settings for our development server. Source maps are used for debugging information. The devServer settings are picked up by webpack-dev-server as it runs.<br><strong>/webpack.config.js dev server settings</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">devtool: <span class="string">'eval-source-map'</span>,</div><div class="line"></div><div class="line">devServer: &#123;</div><div class="line">	historyApiFallback: <span class="literal">true</span>,</div><div class="line">	hot: <span class="literal">true</span>,</div><div class="line">	inline: <span class="literal">true</span>,</div><div class="line">	progress: <span class="literal">true</span>,</div><div class="line">	</div><div class="line">	stats: <span class="string">'errors-only'</span>,</div><div class="line">	</div><div class="line">	host: process.env.HOST,</div><div class="line">	port: process.env.PORT</div><div class="line">&#125;,</div></pre></td></tr></table></figure>
</li>
<li><p>We now wrap up by adding plugins needed during our development.</p>
</li>
</ol>
<p><strong>/webpack.config.js plugins</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">plugins: [</div><div class="line">	<span class="keyword">new</span> HtmlWebpackPlugin(&#123;</div><div class="line">		template: <span class="string">'node_modules/html-webpack-template/index.ejs'</span>,</div><div class="line">		title: <span class="string">'React Speed Coding'</span>,</div><div class="line">		appMountId: <span class="string">'app'</span>,</div><div class="line">		inject: <span class="literal">false</span></div><div class="line">	&#125;),</div><div class="line">	<span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</div><div class="line">	]</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="Configuring-startup-scripts"><a href="#Configuring-startup-scripts" class="headerlink" title="Configuring startup scripts"></a>Configuring startup scripts</h3><p>We can configure startup scripts in package.json to speed up our development even further.<br><strong>/package.json startup scripts</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="string">"scripts"</span>: &#123;</div><div class="line">	<span class="string">"start"</span>: <span class="string">"NODE_ENV=development webpack-dev-server"</span>,</div><div class="line">	<span class="comment">//"start": "set NODE_ENV=development&amp;&amp;webpack-dev-server",           //for windows os</span></div><div class="line">	<span class="string">"build"</span>: <span class="string">"NODE_ENV=production webpack"</span></div><div class="line">	<span class="comment">//"build": "set NODE_ENV=production&amp;&amp;webpack --config webpack.prod.config.js",        //for windows os</span></div><div class="line">&#125;,</div></pre></td></tr></table></figure></p>
<p>Both webpack and the webpack-dev-server will pick up webpack.config.js file configuration.</p>
<h3 id="ES7-Property-Initializers"><a href="#ES7-Property-Initializers" class="headerlink" title="ES7 Property Initializers"></a>ES7 Property Initializers</h3><p>Earlier we were using class properties by defining CardStack.propTypes and Card-Stack.defaultProps outside of the class definition. Now using babel-plugin-transform-class-properties <strong>we can bring these within the class definition</strong>.<br><strong>Install the Babel plugin supporting this ES7 transform</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev babel-plugin-transform-class-properties</div></pre></td></tr></table></figure></p>
<p><strong>/.babelrc  update for new plugin</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">	<span class="string">"presets"</span>: [<span class="string">"react"</span>, <span class="string">"es2015"</span>],</div><div class="line">	<span class="string">"env"</span>: &#123;</div><div class="line">		<span class="string">"development"</span>: &#123;</div><div class="line">			<span class="string">"presets"</span>: [<span class="string">"react-hmre"</span>]</div><div class="line">		&#125;</div><div class="line">	&#125;,</div><div class="line">	<span class="string">"plugins"</span>: [<span class="string">"transform-class-properties"</span>]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="Add-production-plugins-and-supporting-dependencies"><a href="#Add-production-plugins-and-supporting-dependencies" class="headerlink" title="Add production plugins and supporting dependencies"></a>Add production plugins and supporting dependencies</h3><p><strong>Add following plugins functionality to Webpack</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev clean-webpack-plugin</div><div class="line">npm install --save-dev extract-text-webpack-plugin</div></pre></td></tr></table></figure></p>
<p>The html-webpack-plugin recommends using html-minifier to minify HTML.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev html-minifier</div></pre></td></tr></table></figure></p>
<h3 id="Webpack-production-configuration"><a href="#Webpack-production-configuration" class="headerlink" title="Webpack production configuration"></a>Webpack production configuration</h3><ol>
<li>Let us create a production version of webpack.config.js so that we can pass this to webpack in the npm run build script.</li>
<li>Initialization section adds the plugins for cleaning build directory for repeat builds and extracting CSS for separate file in production.</li>
<li>We also parse the package.json dependencies for creating separate vendor and manifest bundles.<br><strong>/webpack.prod.config.js initialization</strong><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</div><div class="line"><span class="keyword">const</span> CleanPlugin = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>);</div><div class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> APP = __dirname + <span class="string">'/app'</span>;</div><div class="line"><span class="keyword">const</span> BUILD = __dirname + <span class="string">'/build'</span>;</div><div class="line"><span class="keyword">const</span> STYLE = __dirname + <span class="string">'/app/style.css'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> PACKAGE = <span class="built_in">Object</span>.keys(</div><div class="line">	<span class="built_in">require</span>(<span class="string">'./package.json'</span>).dependencies</div><div class="line">);</div></pre></td></tr></table></figure>
</li>
</ol>
<p>For production use case it adds chunkhash to file names. This optimizes browser cache and CDN storage/retrieval as only updated files are downloaded as you apply patches to your production code.<br><strong>/webpack.prod.config.js  chunkhash</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">module.exports = &#123;</div><div class="line">	entry: &#123;</div><div class="line">		app: APP,</div><div class="line">		style: STYLE,</div><div class="line">		vendor: PACKAGE</div><div class="line">	&#125;,</div><div class="line">	resolve: &#123;</div><div class="line">		extensions: [<span class="string">''</span>, <span class="string">'.js'</span>, <span class="string">'.jsx'</span>]</div><div class="line">	&#125;,</div><div class="line">	output: &#123;</div><div class="line">		path: BUILD,</div><div class="line">		filename: <span class="string">'[name].[chunkhash].js'</span>,</div><div class="line">		chunkFilename: <span class="string">'[chunkhash].js'</span></div><div class="line">	&#125;,</div></pre></td></tr></table></figure></p>
<ol>
<li>We continue using Babel loader for JSX files. </li>
<li>For CSS we use <strong>extract text plugin</strong> so we can generate separate CSS file. This helps in browser caching as well as avoids FOUC or Flash Of Unstyled Content during initial app loading within the browser.<br><strong>/webpack.prod.config.js   extract css loader</strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">module: &#123;</div><div class="line">	loaders: [</div><div class="line">		&#123;</div><div class="line">			<span class="built_in">test</span>: /\.jsx?$/,</div><div class="line">			loaders: [<span class="string">'babel?cacheDirectory'</span>],</div><div class="line">			include: APP</div><div class="line">		&#125;,</div><div class="line">		// Extract CSS during build</div><div class="line">		&#123;</div><div class="line">			<span class="built_in">test</span>: /\.css$/,</div><div class="line">			loader: ExtractTextPlugin.extract(<span class="string">'style'</span>, <span class="string">'css'</span>),</div><div class="line">			include: APP</div><div class="line">		&#125;</div><div class="line">	]</div><div class="line">&#125;,</div></pre></td></tr></table></figure>
</li>
</ol>
<p>In the next and final section on adding plugins is where our production pipeline actually kicks in.<br><strong>1. Clean build.</strong> We start by cleaning our build directory of any past builds.<br><strong>2. Optimize HTML.</strong> Then we continue with HTML webpack plugin to generate index.html. We add <strong>HTML minifying capability</strong>.<br><strong>3. Extract CSS.</strong> Next the CSS is extracted as a separate file.<br><strong>4. Optionally Dedupe.</strong> Larger projects may have dependency trees with duplicate files. Dedupe plugin removes such duplications. This option is commented out in the starter project as it has few dependencies and has no affect on the build size.<br><strong>5. Separate JS bundles.</strong> Vendor and manifest JavaScript files are bundled separately. This also helps in browser/CDN caching as you may only do a release where one of them is updated, the other does not need to be downloaded again to the client.<br><strong>6. React for production.</strong> Facebook recommends React production settings to optimize<br>the React library payload.<br><strong>7. Minify JS.</strong> Finally we minify the JavaScript.<br>Once you have created your production webpack config. You can update the npm run build script like so.<br><strong>/webpack.prod.config.js plugins</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">plugins: [</div><div class="line">	<span class="keyword">new</span> CleanPlugin([BUILD]),</div><div class="line">	<span class="keyword">new</span> HtmlWebpackPlugin(&#123;</div><div class="line">		template: <span class="string">'node_modules/html-webpack-template/index.ejs'</span>,</div><div class="line">		title: <span class="string">'React Speed Coding'</span>,</div><div class="line">		appMountId: <span class="string">'app'</span>,</div><div class="line">		inject: <span class="literal">false</span>,</div><div class="line">		<span class="comment">// Use html-minifier</span></div><div class="line">		minify: &#123;</div><div class="line">			collapseWhitespace: <span class="literal">true</span></div><div class="line">		&#125;</div><div class="line">	&#125;),</div><div class="line">	<span class="keyword">new</span> ExtractTextPlugin(<span class="string">'[name].[chunkhash].css'</span>),</div><div class="line">	<span class="keyword">new</span> webpack.optimize.DedupePlugin(),</div><div class="line">	<span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</div><div class="line">		names: [<span class="string">'vendor'</span>, <span class="string">'manifest'</span>]</div><div class="line">	&#125;),</div><div class="line">	<span class="keyword">new</span> webpack.DefinePlugin(&#123;</div><div class="line">		<span class="string">'process.env'</span>: &#123;</div><div class="line">			<span class="string">'NODE_ENV'</span>: <span class="built_in">JSON</span>.stringify(<span class="string">'production'</span>)</div><div class="line">		&#125;</div><div class="line">	&#125;),</div><div class="line">	<span class="keyword">new</span> webpack.optimize.UglifyJsPlugin(&#123;</div><div class="line">		compress: &#123;</div><div class="line">			warnings: <span class="literal">false</span></div><div class="line">		&#125;</div><div class="line">	&#125;)</div><div class="line">]</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><strong>/package.json script</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"build"</span>: <span class="string">"NODE_ENV=production webpack --config webpack.prod.config.js"</span></div></pre></td></tr></table></figure></p>
<h3 id="Public-assets"><a href="#Public-assets" class="headerlink" title="Public assets"></a>Public assets</h3><p>Your production app will have several public assets including images, icons, among others. We add /app/public folder and use this to store such public assets. During build we want to copy this folder over to build folder. We add CopyWebpackPlugin to our environment.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev copy-webpack-plugin</div></pre></td></tr></table></figure></p>
<p><strong>Update webpack prod config initialization</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">'copy-webpack-plugin'</span>);</div><div class="line"><span class="keyword">const</span> PUBLIC = __dirname + <span class="string">'/app/public'</span>;</div></pre></td></tr></table></figure></p>
<p>We also add the plugin to our Webpack processing pipeline.<br><strong>Update webpack config plugins</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> CopyWebpackPlugin([</div><div class="line">	&#123; <span class="keyword">from</span>: PUBLIC, to: BUILD &#125;</div><div class="line">],</div><div class="line">&#123;</div><div class="line">	ignore: [</div><div class="line">		<span class="string">'.DS_Store'</span></div><div class="line">	]</div><div class="line">&#125;),</div></pre></td></tr></table></figure></p>
<h3 id="Custom-index-template"><a href="#Custom-index-template" class="headerlink" title="Custom index template"></a>Custom index template</h3><p>We can now add a <strong>custom template</strong> to generate index.html using HtmlWebpackPlugin. This enables us to add viewport tag to support mobile responsive scaling of our app. We also add icons for mobile devices. Following best practices from HTML5Boilerplate, we add html5shiv to handle IE9 and upgrade warning for IE8 users.<br><strong>/app/templates/index_default.html custom template</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html class="no-js" lang=""&gt;</div><div class="line">	&lt;head&gt;</div><div class="line">		&lt;meta charset="utf-8"&gt;</div><div class="line">		&lt;meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"&gt;</div><div class="line">		&lt;title&gt;React Speed Coding&lt;/title&gt;</div><div class="line">		&lt;meta name="description" content=""&gt;</div><div class="line">		&lt;meta name="viewport" content="width=device-width, initial-scale=1\"&gt;</div><div class="line"></div><div class="line">		&lt;link rel="icon" href="/favicon.ico" /&gt;</div><div class="line">		&lt;!--[if lt IE 9]&gt;</div><div class="line">			&lt;script src="//html5shiv.googlecode.com/svn/trunk/html5.js"&gt;&lt;/script&gt;</div><div class="line">			&lt;script&gt;window.html5 || document.write('&lt;script src="js/html5shiv.js"&gt;&lt;/script&gt;')&lt;/script&gt;</div><div class="line">		&lt;![endif]--&gt;</div><div class="line">	&lt;/head&gt;</div><div class="line">	&lt;body&gt;</div><div class="line">		&lt;!--[if lt IE 8]&gt;</div><div class="line">			&lt;p class="browserupgrade"&gt;You are using an &lt;strong&gt;outdated&lt;/strong&gt; browser. Please &lt;a href="http://browsehappy.com/"&gt;upgrade your browser&lt;/a&gt; to improve your experience.&lt;/p&gt;</div><div class="line">		&lt;![endif]--&gt;</div><div class="line">		&lt;div id="app"&gt;&lt;/div&gt;</div><div class="line">		&lt;!-- Google Analytics: change UA-XXXXX-X to be your site's ID. --&gt;</div><div class="line">	&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<p>书上卸载此插件，但是我没有<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm uninstall --save-dev html-webpack-template</div></pre></td></tr></table></figure></p>
<p>Updating webpack configs for HtmlWebpackPlugin.<br><strong>Update webpack config plugins</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> TEMPLATE = __dirname + <span class="string">'/app/templates/index_default.html'</span></div><div class="line"></div><div class="line"><span class="keyword">new</span> HtmlWebpackPlugin(&#123;</div><div class="line">	template: TEMPLATE,</div><div class="line">	inject: <span class="string">'body'</span></div><div class="line">&#125;),</div></pre></td></tr></table></figure></p>
<p>Updating the plugins section for both webpack configs.</p>
<h3 id="Normalize-css-from-NPM"><a href="#Normalize-css-from-NPM" class="headerlink" title="Normalize.css from NPM"></a>Normalize.css from NPM</h3><p>Normalize.css provides base styles and resets for our app. It is well maintained stylesheet and receives regular updates.<br><strong>Add it as npm dependency</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev normalize-css</div></pre></td></tr></table></figure></p>
<p>Now we add postcss-easy-import which enables Webpack build to process @import even from node_modules directory directly.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev postcss-easy-import</div></pre></td></tr></table></figure></p>
<p>Importing postcss-easy-import in Webpack configs and adding a plugin for processing @import like so. This enables processing partials with _prefix along with any css available as an npm dependency as well.<br><strong>Update both webpack config plugins</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> PostcssImport = <span class="built_in">require</span>(<span class="string">'postcss-easy-import'</span>);</div><div class="line"><span class="comment">// some code...</span></div><div class="line">postcss: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">return</span> [</div><div class="line">		PostcssImport(&#123;</div><div class="line">			addDependencyTo: webpack,</div><div class="line">			prefix: <span class="string">'_'</span></div><div class="line">		&#125;),</div><div class="line">		precss,</div><div class="line">		autoprefixer(&#123; browsers: [<span class="string">'last 2 versions'</span>] &#125;)</div><div class="line">	]</div><div class="line">&#125;,</div></pre></td></tr></table></figure></p>
<p>Now whenever normalize.css changes, we can run <figure class="highlight plain"><figcaption><span>update``` to update our development environment with ease.</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">This also sets us up for adding more npm maintained styles in the future.</div><div class="line"></div><div class="line">### CSS minifying</div><div class="line">The css-loader uses cssnano as a dependency which in turn uses postcss-discard-comments plugin to minify CSS output.</div><div class="line"></div><div class="line">### Postcss processing</div><div class="line">As a simple analogy, PostCSS does for CSS what Babel does for JS.</div><div class="line">**Autoprefixer.** You can write latest CSS rules and PostCSS Autoprefixer will add vendor prefixes based on current browser popularity and support. Your post-processed CSS always stays up-to-date with latest browser compatibility.</div><div class="line">**CSSnext.** Future-proofing your code, use latest CSS features today. PostCSS coverts to CSS current browsers support.</div><div class="line">**CSS Modules.** Make your CSS code more modular, reusable, and maintainable.</div><div class="line">**Speed.** PostCSS is faster than Less, Sass, others, when it concerns your development pipeline. </div><div class="line">**Plugins.** PostCSS ecosystem has several plugins including Global CSS fixes, CSS readability, future CSS, images and fonts, linters, and syntaxes similar to SCSS, SASS, LESS. See list of plugins here. You can search plugins in a catalog at postcss.parts.</div><div class="line">We use following plugins for building Speed UI.</div><div class="line">- The Autoprefixer plugin, so that we don’t need to worry about browser prefixes anymore.</div><div class="line">- The PreCSS plugin enables Sass-like markup within CSS.</div><div class="line"></div><div class="line">### Update Webpack for PostCSS</div><div class="line">Before we proceed we need to add support for PostCSS in our build pipeline.</div><div class="line">**Install PostCSS loader and dependencies**</div><div class="line">```bash</div><div class="line">	npm install --save-dev postcss-loader</div><div class="line">	npm install --save-dev precss</div><div class="line">	npm install --save-dev autoprefixer</div></pre></td></tr></table></figure></p>
<p>Update Webpack configs (development and production) with PostCSS plugins import.<br><strong>Init PostCSS dependencies in both configs</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> precss = <span class="built_in">require</span>(<span class="string">'precss'</span>);</div><div class="line"><span class="keyword">const</span> autoprefixer = <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>);</div></pre></td></tr></table></figure></p>
<p>Development config will add postcss loader to css loaders.<br><strong>/webpack.config.js add PostCSS loader</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>: &#123;</div><div class="line">	loaders: [</div><div class="line">		&#123;</div><div class="line">			test: <span class="regexp">/\.jsx?$/</span>,</div><div class="line">			loaders: [<span class="string">'babel?cacheDirectory'</span>],</div><div class="line">			include: APP</div><div class="line">		&#125;,</div><div class="line">		&#123;</div><div class="line">			test: <span class="regexp">/\.css$/</span>,</div><div class="line">			loaders: [<span class="string">'style'</span>, <span class="string">'css'</span>, <span class="string">'postcss'</span>],</div><div class="line">			include: APP</div><div class="line">		&#125;</div><div class="line">	]</div><div class="line">&#125;,</div><div class="line">postcss: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">return</span> [precss, autoprefixer];</div><div class="line">&#125;,</div></pre></td></tr></table></figure></p>
<p>Production config will add postcss loader to ExtractTextPlugin.<br><strong>/webpack.prod.config.js add PostCSS loader</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>: &#123;</div><div class="line">	loaders: [</div><div class="line">		&#123;</div><div class="line">			test: <span class="regexp">/\.jsx?$/</span>,</div><div class="line">			loaders: [<span class="string">'babel?cacheDirectory'</span>],</div><div class="line">			include: APP</div><div class="line">		&#125;,</div><div class="line">		<span class="comment">// Extract CSS during build</span></div><div class="line">		&#123;</div><div class="line">			test: <span class="regexp">/\.css$/</span>,</div><div class="line">			loader: ExtractTextPlugin.extract(<span class="string">'style'</span>, <span class="string">'css!postcss'</span>),</div><div class="line">			include: APP</div><div class="line">		&#125;</div><div class="line">	]</div><div class="line">&#125;,</div><div class="line">postcss: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">return</span> [precss, autoprefixer];</div><div class="line">&#125;,</div></pre></td></tr></table></figure></p>
<h2 id="ORANGNIZING-AND-MODULARIZING-STYLES"><a href="#ORANGNIZING-AND-MODULARIZING-STYLES" class="headerlink" title="ORANGNIZING AND MODULARIZING STYLES"></a>ORANGNIZING AND MODULARIZING STYLES</h2><p>Right now from Setup React Webpack chapter you have a very basic style.css located at app root.</p>
<ol>
<li>First, let us create a _theme.css to specify reusable theme variables. That way our css can refer to these variables. Changes in one file will impact our entire UI library.</li>
</ol>
<p><strong>/app/styles/theme.css Page styles</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$font-stack: Arial, Helvetica, sans-serif;</div><div class="line">$page-background: $white;</div><div class="line">$page-padding: 2em;</div></pre></td></tr></table></figure></p>
<ol>
<li>Notice the variable $white is not defined yet. Before page styles, we need to define our primary color palette.</li>
</ol>
<p><strong>/app/styles/theme.css Primary color palette</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$white: floralwhite;</div><div class="line">$blue: color(deepskyblue lightness(30%));</div><div class="line">$red: tomato;</div><div class="line">$yellow: wheat;</div><div class="line">$black: #4D4E53; /* charcoal gray */</div></pre></td></tr></table></figure></p>
<ol>
<li>As you can see we have started using Sass-like calculations within CSS. PostCSS will process this and convert to normal CSS.</li>
</ol>
<p><strong>/app/styles/theme.css Secondary colors</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$fadeblue: color(deepskyblue saturation(30%));</div><div class="line">$lightblue: color(deepskyblue lightness(80%));</div><div class="line">$fadesand: color(wheat saturation(30%));</div><div class="line">$sand: color(wheat lightness(80%));</div><div class="line">$gray: color($black lightness(80%));</div></pre></td></tr></table></figure></p>
<ol>
<li>Changes in few areas will change the whole theme for you. This wraps up the basic theme for us.</li>
</ol>
<p><strong>/app/styles/theme.css Base typography</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$h1-font-size: 3em;</div><div class="line">$h2-font-size: calc( $h1-font-size * 80 / 100 );</div><div class="line">$h3-font-size: calc( $h1-font-size * 60 / 100 );</div><div class="line">$h4-font-size: calc( $h1-font-size * 40 / 100 );</div><div class="line">$normal-font-size: calc( $h1-font-size * 33.3 / 100 );</div><div class="line">$h1-line-height: 50px;</div><div class="line">$h2-line-height: calc( $h1-line-height * 80 / 100 );</div><div class="line">$h3-line-height: calc( $h1-line-height * 60 / 100 );</div><div class="line">$h4-line-height: calc( $h1-line-height * 40 / 100 );</div><div class="line">$normal-line-height: calc( $h1-line-height * 33.3 / 100 );</div><div class="line">$heading-color: $black;</div><div class="line">$normal-font-color: $black;</div><div class="line">$link-color: $blue;</div></pre></td></tr></table></figure></p>
<ol>
<li>Let us now create _base.css and move the body styles there, while using variables instead of hard coded values.</li>
</ol>
<p><strong>/app/styles/base.css</strong><br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">body</span> &#123;</div><div class="line">	<span class="attribute">color</span>: $normal-font-color;</div><div class="line">	<span class="attribute">background</span>: $page-background;</div><div class="line">	<span class="attribute">font-family</span>: $font-stack;</div><div class="line">	<span class="attribute">padding</span>: $page-padding;</div><div class="line">	<span class="attribute">font-size</span>: <span class="number">100%</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ol>
<li>We also create _type.css and do away with the .title-shadow style in favor of using headers. This will simplify our Hello component.</li>
</ol>
<p><strong>/app/styles/type.css</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">p &#123;</div><div class="line">	color: $normal-font-color;</div><div class="line">	font-size: $normal-font-size;</div><div class="line">	line-height: $normal-line-height;</div><div class="line">&#125;</div><div class="line">.heading &#123;</div><div class="line">	color: $heading-color;</div><div class="line">	font-weight: lighter;</div><div class="line">	text-shadow: 0 1px 0 $white;</div><div class="line">&#125;</div><div class="line">h1 &#123;</div><div class="line">	@extend .heading;</div><div class="line">	font-size: $h1-font-size;</div><div class="line">	line-height: $h1-line-height;</div><div class="line">&#125;</div><div class="line">h2 &#123;</div><div class="line">	@extend .heading;</div><div class="line">	font-size: $h2-font-size;</div><div class="line">	line-height: $h2-line-height;</div><div class="line">&#125;</div><div class="line">h3 &#123;</div><div class="line">	@extend .heading;</div><div class="line">	font-size: $h3-font-size;</div><div class="line">	line-height: $h3-line-height;</div><div class="line">&#125;</div><div class="line">h4 &#123;</div><div class="line">	@extend .heading;</div><div class="line">	font-size: $h4-font-size;</div><div class="line">	line-height: $h4-line-height;</div><div class="line">&#125;</div><div class="line">a &#123;</div><div class="line">	color: $link-color;</div><div class="line">	text-decoration: none;</div><div class="line">	font-weight: lighter;</div><div class="line">	&amp;:hover &#123;</div><div class="line">		text-decoration: underline;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ol>
<li>We use more Sass-like features here including inheritance with @extend and nesting. Now all that is left is to include all the partials or CSS modules we just created within style.css.</li>
</ol>
<p><strong>/app/style.css   Import partials</strong><br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@<span class="keyword">import</span> <span class="string">'styles/theme'</span>;</div><div class="line">@<span class="keyword">import</span> <span class="string">'styles/base'</span>;</div><div class="line">@<span class="keyword">import</span> <span class="string">'styles/type'</span>;</div></pre></td></tr></table></figure></p>
<h3 id="Flexbox-layouts"><a href="#Flexbox-layouts" class="headerlink" title="Flexbox layouts"></a>Flexbox layouts</h3><p>Flexbox is a CSS standard. It is also much less code to create layouts using Flexbox, as the task of calculating grid size, placement, alignment, number of fitting elements is left to the browser, instead of the designer. You can say Flexbox is more “developer friendly” in that sense.</p>
<p><strong>Display.</strong> First statement sets the display to flex instead of block or other options.<br><strong>Flow.</strong> Next flex-flow sets the flow of contained elements by row or column, wrapping or nowrap, forward direction or reverse.<br><strong>Justify.</strong> Finally, justify-content decides how contained elements will be placed in relation to each other. Options include space around, align with start of container, align with end, center, and space in between.<br>Also note that <strong>Flexbox styling only needs to be specified within the container.</strong><br><strong>/app/styles/card.css CardStack styles</strong><br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.stack</span> &#123;</div><div class="line">	<span class="attribute">padding</span>: <span class="number">0</span>;</div><div class="line">	<span class="attribute">margin</span>: <span class="number">0</span>;</div><div class="line">	<span class="attribute">list-style</span>: none;</div><div class="line">	<span class="attribute">display</span>: flex;</div><div class="line">	<span class="attribute">flex-flow</span>: row wrap;</div><div class="line">	<span class="attribute">justify-content</span>: space-around;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="Issue-using-Hot-Reloading-with-CSS-imports"><a href="#Issue-using-Hot-Reloading-with-CSS-imports" class="headerlink" title="Issue using Hot Reloading with CSS imports"></a>Issue using Hot Reloading with CSS imports</h3><p>This issue is still there.</p>
<h3 id="Start-component-design"><a href="#Start-component-design" class="headerlink" title="Start component design"></a>Start component design</h3><p>此处与书中的顺序不同，把后面的内容前移了一部分，使代码能够正确运行。<br>Step 1: We determine that our root level component will be simply called Page.<br>Step 2, 3: CSS Tricks sample is nicely modularized in HTML and CSS, so this makes it easier for us to follow the above mentioned workflow.<br>Step 4: Note that we replaced some of the sample HTML within article tag with our reusable CardStack component.<br>Step 5: We copy the CSS styles into two new partials for navigation and page wrapper. We further reduce the CSS code and make it more reusable by using nesting from PostCSS and variables from the _theme.css we defined earlier.<br>Once you are done adding this partial, you can update /app/style.css by adding @import new partial name;.<br>Step 6: For this sample we can skip JS integration. However, in earlier chapter on Production Optimize Webpack we follow this strategy to integrate html5shiv JavaScript into /app/public/js folder.<br>Step 7: Now all that remains is to import the new Page component into index.jsx and update the render() method to render our component like so.</p>
<h3 id="Embed-to-React"><a href="#Embed-to-React" class="headerlink" title="Embed to React"></a>Embed to React</h3><p>Strategy for converting embed code to React component is straightforward.</p>
<ul>
<li>Customize the embed code within target platform to suit your site or app styles and placement.</li>
<li>Optionally, parametrize the embed code attributes using React props.</li>
<li>Use stateless component as you will most likely not maintain embed UI state locally within your React component. Embed code will handle its own UI state.</li>
</ul>
<ol>
<li><p>Custom YouTube embed code</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;iframe width=<span class="string">"200"</span> height=<span class="string">"113"</span></div><div class="line">	src=<span class="string">"https://www.youtube.com/embed/MGuKhcnrqGA?rel=0&amp;amp;controls=0&amp;amp;showinfo=0"</span></div><div class="line">	frameborder=<span class="string">"0"</span> allowfullscreen&gt;</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span></div></pre></td></tr></table></figure>
</li>
<li><p>Note that the video id is part of URL following /embed/. This turns into our only property we pass on to the component.</p>
</li>
<li>We create a stateless component using pure function definition. The component takes one property videoid and renders the embed code.</li>
</ol>
<p><strong>/app/components/YouTube.jsx YouTube component</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">YouTube</span>(<span class="params">props</span>) </span>&#123;</div><div class="line">	<span class="keyword">const</span> source = <span class="string">`https://www.youtube.com/embed/<span class="subst">$&#123;props.videoid&#125;</span>?rel=0&amp;amp;controls=0&amp;amp;showinfo=0`</span>;</div><div class="line">	<span class="keyword">return</span> (</div><div class="line">		<span class="xml"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"auto"</span></span></span></div><div class="line">			<span class="attr">src</span>=<span class="string">&#123;source&#125;</span></div><div class="line">			<span class="attr">frameborder</span>=<span class="string">"0"</span> <span class="attr">allowfullscreen</span>&gt;</div><div class="line">		<span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></div><div class="line">	);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ol>
<li>Render it in parent component.</li>
</ol>
<h3 id="CSS-libraries-to-React"><a href="#CSS-libraries-to-React" class="headerlink" title="CSS libraries to React"></a>CSS libraries to React</h3><p>Normally you would bring these CSS libraries into your React project using one of the following ways.</p>
<ul>
<li>Use <figure class="highlight plain"><figcaption><span>rel="stylesheet" href="//url/to/library.min.css"/>``` to reference the library if it is hosted on a CDN.</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">- Add a popular library as an NPM dependency and @import it within style.css.</div><div class="line">- Add a library that does not change frequently as a partial and @import it within style.css.</div><div class="line"></div><div class="line">Next you would refer to the library classes within your HTML code.</div><div class="line">Using React components you can further speed up your usage of such libraries. If the CSS libraries themselves have UI components or controls, these can be represented as React components. This enables you to create shortcuts to using the library code. You can even do custom processing, apply your own styles, before rendering the CSS</div><div class="line">library code.</div><div class="line">We follow this strategy to convert CSS libraries to React components.</div><div class="line">1. Decide how to import or integrate the library within your React app.</div><div class="line">2. Identify component(s) from within the library to determine equivalent React components.</div><div class="line">3. Optionally, parametrize any style attributes and repeating elements within the CSS library as React component properties.</div><div class="line">4. Reuse the React component in place of CSS library elements within your app.</div><div class="line"></div><div class="line">**Step 1:** As Font Awesome is a popular library and is available over a world class CDN (BootstrapCDN by MaxCDN), easiest way to integrate this CSS library into our app is to add it to index_default.html.</div><div class="line">**/app/templates/index_default.html Link Font Awesome CSS library**</div><div class="line">```js</div><div class="line">	&lt;link rel=&quot;stylesheet&quot; href=&quot;//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css&quot;&gt;</div></pre></td></tr></table></figure></li>
</ul>
<p><strong>Step 2:</strong> Next we identify which elements of Font Awesome library are candidates for converting to React components. This is a relatively straightforward decision as Font Awesome is all about icons. So we can create a reusable React component called Icon. Let us go a step further into the requirements of our app. We would like to display stats and infographics in our cards, so our icons will also have an associated text message. So let us call our React Component IconText and move on to the next step.</p>
<p><strong>Step 3:</strong> Now we identify repeating elements and configurable attributes of the CSS library, in order to turn these into our component properties. Font Awesome icons can be configured using a rich combination of classes to determine size, orientation, icon graphic, among other features. All these attributes are candidates for converting<br>to React component properties.<br>Let us see how our new React component is shaping up.<br><strong>/app/components/IconText.jsx Font Awesome icon and text component</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123; PropTypes &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">IconText</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">	<span class="keyword">static</span> propTypes = &#123;</div><div class="line">		icon: PropTypes.string.isRequired,</div><div class="line">		text: PropTypes.string.isRequired,</div><div class="line">		className: PropTypes.string,</div><div class="line">		size: PropTypes.oneOf([<span class="string">'lg'</span>, <span class="string">'2x'</span>, <span class="string">'3x'</span>, <span class="string">'4x'</span>, <span class="string">'5x'</span>]),</div><div class="line">		rotate: PropTypes.number,</div><div class="line">		flip: PropTypes.oneOf([<span class="string">'horizontal'</span>, <span class="string">'vertical'</span>]),</div><div class="line">		inverse: PropTypes.bool</div><div class="line">	&#125;</div><div class="line">	render () &#123;</div><div class="line">		<span class="keyword">let</span> &#123;</div><div class="line">			icon, text, className, size, rotate,</div><div class="line">			flip, stack, inverse</div><div class="line">		&#125; = <span class="keyword">this</span>.props;</div><div class="line">		<span class="keyword">let</span> variation = <span class="string">""</span>;</div><div class="line">		variation += className ? <span class="string">` <span class="subst">$&#123;className&#125;</span>`</span> : <span class="string">""</span>;</div><div class="line">		variation += size ? <span class="string">` fa-<span class="subst">$&#123;size&#125;</span>`</span> : <span class="string">""</span>;</div><div class="line">		variation += rotate ? <span class="string">` fa-rotate-<span class="subst">$&#123;rotate&#125;</span>`</span> : <span class="string">""</span>;</div><div class="line">		variation += flip ? <span class="string">` fa-flip-<span class="subst">$&#123;flip&#125;</span>`</span> : <span class="string">""</span>;</div><div class="line">		variation += inverse ? <span class="string">` fa-inverse`</span> : <span class="string">""</span>;</div><div class="line"></div><div class="line">		<span class="keyword">const</span> iconClass = <span class="string">`fa fa-<span class="subst">$&#123;icon&#125;</span><span class="subst">$&#123;variation&#125;</span>`</span>;</div><div class="line">		<span class="keyword">return</span> (</div><div class="line">			<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">				<span class="tag">&lt;<span class="name">i</span> <span class="attr">className</span>=<span class="string">&#123;iconClass&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">h4</span>&gt;</span>&#123;text&#125;<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Step 4: Now we reuse our new component within CardStack to render some new IconText component variants.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">&lt;IconText className=<span class="string">"blue"</span> icon=<span class="string">"globe"</span> size=<span class="string">"5x"</span> text=<span class="string">"Nine Component Creation Strategies"</span> /&gt;</div><div class="line">......</div></pre></td></tr></table></figure></p>
<h3 id="API-to-React"><a href="#API-to-React" class="headerlink" title="API to React"></a>API to React</h3><p>There are benefits of turning an API access, processing, and data rendering code into a React component.</p>
<ul>
<li>You can map API endpoints to React properties.</li>
<li>You can provide reusable UI components wrapping the API functionality.</li>
</ul>
<p>Strategy for designing a React component from an external API is as follows.</p>
<ol>
<li>Identify a public API which can be accessed without authentication requirements and supporting JSON as results data format.</li>
<li>Optionally, parametrize API endpoints to React properties.</li>
<li>API resulting JSON can be parametrized as component state. As the results change, we want the state to change, and the component render() to be invoked.</li>
<li>Render the new component within your app.</li>
</ol>
<p><strong>Step 1:</strong> For our new component we decide to use the GitHub API. Type this in the terminal to make a REST GET call to the GitHub API and observe the resulting JSON. This particular API endpoint sends back results with GitHub repository details including number of stars and open issues.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://api.github.com/repos/facebook/react</div></pre></td></tr></table></figure></p>
<p><strong>Step 2:</strong> The GitHub API endpoint follows /repos/:owner/:repository format. Owner and repository can vary for our app, and these are good candidates to be combined as a component property.<br><strong>Step 3:</strong> We want to extract number of stars, open issues, and formal name of the repository from the resulting JSON. These will be part of our component state as using AJAX GET request we want our state to be updated when the results are fetched to the browser.</p>
<p>For the AJAX functionality we integrate jQuery with our app. We follow the easiest strategy, same as we followed for Font Awesome integration. We add jQuery to index_default.html like so.<br><strong>/app/templates/index_default.html add jQuery</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;script src=<span class="string">"//ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div></pre></td></tr></table></figure></p>
<p><strong>/app/components/GitHub.jsx component definition</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">componentDidMount() &#123;</div><div class="line">	<span class="keyword">const</span> sourceRepo =</div><div class="line">		<span class="string">`https://api.github.com/repos/<span class="subst">$&#123;this.props.repo&#125;</span>`</span>;</div><div class="line">	<span class="keyword">this</span>.serverRequest = $.get(sourceRepo, <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</div><div class="line">		<span class="keyword">this</span>.setState(&#123;</div><div class="line">			full_name: result.full_name,</div><div class="line">			stargazers_count: result.stargazers_count,</div><div class="line">			open_issues: result.open_issues</div><div class="line">		&#125;);</div><div class="line">	&#125;.bind(<span class="keyword">this</span>));</div><div class="line">&#125;</div><div class="line">componentWillUnmount() &#123;</div><div class="line">	<span class="keyword">this</span>.serverRequest.abort();</div><div class="line">&#125;</div><div class="line">......</div></pre></td></tr></table></figure></p>
<p><strong>/app/components/CardStack.jsx render GitHub</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> GitHub <span class="keyword">from</span> <span class="string">'./GitHub.jsx'</span>;</div><div class="line"><span class="comment">// some code...</span></div><div class="line">&lt;li key=<span class="string">"github-react"</span> className=<span class="string">"card demo"</span>&gt;</div><div class="line">	<span class="xml"><span class="tag">&lt;<span class="name">GitHub</span> <span class="attr">repo</span>=<span class="string">"facebook/react"</span> /&gt;</span>,</span></div><div class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="Integrating-vendor-components"><a href="#Integrating-vendor-components" class="headerlink" title="Integrating vendor components"></a>Integrating vendor components</h3><p>We decide to include Rumble Charts as a vendor component matching the selection criteria we just defined. They offer one of the best documented React component libraries for adding charting using another best of breed library D3.js.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save rumble-charts</div></pre></td></tr></table></figure></p>
<h3 id="CSS-design-methodologies"><a href="#CSS-design-methodologies" class="headerlink" title="CSS design methodologies"></a>CSS design methodologies</h3><p>Large CSS implementations are infamous for difficulty in maintainability. You can do three things to make your CSS code as readable, reusable, and robust as your React code.</p>
<ul>
<li>Follow component oriented design principles we follow in our React code.</li>
<li>Use naming conventions based on well established methodologies.</li>
<li>Incorporate linting and pre/post processing tools automation in your build pipeline.</li>
</ul>
<p>We will focus on first two points, following component oriented design principle to develope our style methodologies.<br>For CSS folders and organization, we will extend the The <strong>7-1 pattern</strong> by Hugo Giraudel, which includes 7 folders for partials and 1 main file for imports. Although the pattern describes Sass organization, it very well applies to CSS with PostCSS.<br>Some guidance on styles organization suggests keeping css and component jsx together. We see several benefits of keeping styles separate and not alongside components.</p>
<ul>
<li>We can organize styles using the popular 7-1 pattern used by many CSS frameworks.</li>
<li>We can organize partials and main imports file in one place.</li>
<li>Styles for container and presentational components can be in the same file. Firstly, these styles are logically related, like flexbox container and child ordering. Secondly, container components have minimal associated style information.</li>
<li>If you have a designer and developer in your team, they could be working on their own folders with clearly defined interfaces in the form of naming conventions and organization principles.</li>
<li>You can easily package your UI library styles for independent distribution if required.</li>
</ul>
<p>Another set of best practices we will follow are <strong>around naming conventions</strong>.<br>Detailed CSS organization and naming best practices include SMACSS, BEM, and OOCSS, among many others.<br>We following simplified guidance from modular CSS naming conventions at The Sass Way, based on BEM and SMACSS.</p>
<p><strong>We will refactor our css code from here.</strong><br>As a starter for our refactoring journey, we are extending the excellent Solved by Flexbox samples repo along with SUIT CSS libraries.<br>Solved by Flexbox is based on BEM with its own variation, so we will refactor the sample code to work with our guidelines.<br>SUIT CSS is one of the most popular CSS libraries on GitHub, also used at Twitter, again using BEM with a few variations.<br>Import relevant SUIT CSS libraries from NPM. These provide utility classes for display types and text truncation, breaking, and alignment.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev suitcss-utils-display</div><div class="line">npm install --save-dev suitcss-utils-text</div></pre></td></tr></table></figure></p>
<h3 id="Refactor-using-ReactSpeed-UI-methodologies"><a href="#Refactor-using-ReactSpeed-UI-methodologies" class="headerlink" title="Refactor using ReactSpeed UI methodologies"></a>Refactor using ReactSpeed UI methodologies</h3><p>Following the 7-1 pattern we separate our styles into following folders.</p>
<ul>
<li>base: Contains theme variables and global resets.</li>
<li>components: Contains partials representing our presentational components.</li>
<li>containers: Partials for our container components.</li>
<li>utils: Media queries, sizing, spacing, and compatibility.</li>
<li>vendor: Specific styles for handling vendor library integration.</li>
</ul>
<p>Our style.css entry point imports the partials in one place. We are no longer using underscore prefix for our partials, so we can make our webpack configs a bit lighter by one line of code.<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">PostcssImport(&#123;</div><div class="line">	addDependencyTo: webpack,</div><div class="line">	<span class="comment">// prefix: '_'</span></div><div class="line">&#125;),</div></pre></td></tr></table></figure></p>
<h3 id="React-Speed-UI-Naming-Methodology"><a href="#React-Speed-UI-Naming-Methodology" class="headerlink" title="React Speed UI Naming Methodology"></a>React Speed UI Naming Methodology</h3><ul>
<li>Owner React component styles are represented as objects or nouns and written in spinal-case. So .card style.</li>
<li>Child nodes or contained React components are parent-child relationships represented as spinal-case.</li>
<li>Parent-child styles are written in noun-noun or parent-object-child-object format.</li>
<li>Parent and child styles are listed side-by-side and DO NOT use nesting. So .card-header style.</li>
<li>Subclasses style component inheritance. Subclasses @extend base style objects. They are written in adjective-base-object format or subclass-base format. So .extended-card may extend .card to add more features.</li>
<li>Modifiers are component properties or state.</li>
<li>Modifiers are force applied to the object or component they refer by using the ampersand operator.</li>
<li>Modifiers are written as adjectives or used descriptively. So &amp;.is-message and &amp;.is-spaced modifiers.</li>
<li>Use nesting selectively only for modifiers, :pseudo-classes like :hover and ::pseudoelements like ::after.</li>
<li>No PascalCase or camelCase. Use hyphens instead.</li>
<li>Alphabetical order of style attributes.</li>
<li>Replace hex, hsl, rgb values of colors with CSS color names.</li>
<li>Later on we can move color names to variables.css and use variables to build our reusable theme.</li>
</ul>
<h2 id="TEST-APP-COMPONENTS"><a href="#TEST-APP-COMPONENTS" class="headerlink" title="TEST APP COMPONENTS"></a>TEST APP COMPONENTS</h2><h3 id="Browsersync-multi-device-testing"><a href="#Browsersync-multi-device-testing" class="headerlink" title="Browsersync multi-device testing"></a>Browsersync multi-device testing</h3><p>As you continue mobile-web app development, you may want to test your app across multiple devices.<br>Let us setup Browsersync for our development environment by installing following dependencies.<br><strong>Browsersync dependencies</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev browser-sync</div><div class="line">npm install --save-dev browser-sync-webpack-plugin</div></pre></td></tr></table></figure></p>
<p>Now let us update our Webpack development config, as Browsersync us primarily a development tool.<br><strong>webpack.config.js adding Browsersync</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// some code...</span></div><div class="line"><span class="keyword">const</span> BrowserSyncPlugin = <span class="built_in">require</span>(<span class="string">'browser-sync-webpack-plugin'</span>);</div><div class="line"><span class="comment">// some code...</span></div><div class="line"><span class="keyword">const</span> HOST = process.env.HOST || <span class="string">'localhost'</span>;</div><div class="line"><span class="keyword">const</span> PORT = process.env.PORT || <span class="number">8080</span>;</div><div class="line"><span class="keyword">const</span> PROXY = <span class="string">'http://'</span> + HOST + <span class="string">':'</span> + PORT;</div><div class="line"><span class="comment">// some code...</span></div><div class="line">devServer: &#123;</div><div class="line">	historyApiFallback: <span class="literal">true</span>,</div><div class="line">	hot: <span class="literal">true</span>,</div><div class="line">	inline: <span class="literal">true</span>,</div><div class="line">	progress: <span class="literal">true</span>,</div><div class="line">	stats: <span class="string">'errors-only'</span>,</div><div class="line">	host: HOST,</div><div class="line">	port: PORT,</div><div class="line">	outputPath: BUILD</div><div class="line">&#125;,</div><div class="line">plugins: [</div><div class="line">	<span class="keyword">new</span> BrowserSyncPlugin(</div><div class="line">	&#123;</div><div class="line">		host: HOST,</div><div class="line">		port: PORT,</div><div class="line">		proxy: PROXY</div><div class="line">	&#125;,</div><div class="line">	&#123;</div><div class="line">		reload: <span class="literal">false</span></div><div class="line">	&#125;</div><div class="line">),</div><div class="line"><span class="comment">// some code...</span></div></pre></td></tr></table></figure></p>
<p>Now you can test your setup by running npm start command in your terminal.</p>
<p>You now get 4 new URLs. Local and external are URLs you can use on multiple local browsers and multiple external devices respectively. UI related URLs enable you to configure Browsersync runtime.</p>
<h3 id="JavaScript-lint-using-ESLint"><a href="#JavaScript-lint-using-ESLint" class="headerlink" title="JavaScript lint using ESLint"></a>JavaScript lint using ESLint</h3><p>Let us test our JavaScript code for good coding practices, getting hints as we code in our editor.<br><strong>ESLint dependencies</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev eslint</div><div class="line">npm install --save-dev eslint-plugin-react</div><div class="line">npm install --save-dev eslint-loader</div><div class="line">npm install --save-dev eslint-friendly-formatter</div><div class="line">npm install --save-dev eslint-config-airbnb</div><div class="line">npm install --save-dev eslint-plugin-import</div><div class="line">npm install --save-dev eslint-plugin-jsx<span class="_">-a</span>11y    //number 11</div><div class="line">npm install --save-dev babel-eslint</div></pre></td></tr></table></figure></p>
<p>Here is a brief explanation of these dependencies.</p>
<ul>
<li>eslint - Core dependency.</li>
<li>eslint-plugin-react - React specific linting rules for ESLint.</li>
<li>eslint-loader - Webpack loader for eslint.</li>
<li>eslint-friendly-formatter - Custom formatter for eslint results. Add a nice summary of errors or warnings in the end, plus highlights statement causing the error or warning.</li>
<li>eslint-config-airbnb - Airbnb style guide based eslint rules.</li>
<li>eslint-plugin-import - Required for linting of ES2015+ (ES6+) import/exportsyntax.</li>
<li>eslint-plugin-jsx-a11y - Support for accessibility rules on JSX elements.</li>
<li>babel-eslint - Parser to replace eslint default if we are using class properties, decorators, async/await, types.</li>
</ul>
<h3 id="Configuring-eslint"><a href="#Configuring-eslint" class="headerlink" title="Configuring eslint"></a>Configuring eslint</h3><p><strong>Init eslint configuration</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">node_modules/.bin/eslint --init</div></pre></td></tr></table></figure></p>
<p>Resulting in eslint configuration file at root of our development folder.<br><strong>.eslintrc.js default configuration</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">	<span class="string">"parser"</span>: <span class="string">"babel-eslint"</span>,</div><div class="line">	<span class="string">"rules"</span>: &#123;</div><div class="line">		<span class="string">"strict"</span>: <span class="number">0</span></div><div class="line">	&#125;,</div><div class="line">	<span class="string">"env"</span>: &#123;</div><div class="line">		<span class="string">"browser"</span>: <span class="literal">true</span>,</div><div class="line">		<span class="string">"commonjs"</span>: <span class="literal">true</span>,</div><div class="line">		<span class="string">"es6"</span>: <span class="literal">true</span></div><div class="line">	&#125;,</div><div class="line">	<span class="string">"extends"</span>: <span class="string">"airbnb"</span>,</div><div class="line">	<span class="string">"parserOptions"</span>: &#123;</div><div class="line">		<span class="string">"ecmaFeatures"</span>: &#123;</div><div class="line">			<span class="string">"experimentalObjectRestSpread"</span>: <span class="literal">true</span>,</div><div class="line">			<span class="string">"jsx"</span>: <span class="literal">true</span></div><div class="line">		&#125;,</div><div class="line">		<span class="string">"sourceType"</span>: <span class="string">"module"</span></div><div class="line">	&#125;,</div><div class="line">	<span class="string">"plugins"</span>: [</div><div class="line">		<span class="string">"react"</span></div><div class="line">	],</div><div class="line">	<span class="string">"rules"</span>: &#123;</div><div class="line">		<span class="string">"comma-dangle"</span>: [</div><div class="line">			<span class="string">"warn"</span>,</div><div class="line">			<span class="string">"never"</span></div><div class="line">		],</div><div class="line">		<span class="string">"indent"</span>: [</div><div class="line">			<span class="string">"warn"</span>,</div><div class="line">			<span class="number">4</span></div><div class="line">		],</div><div class="line">		<span class="string">"linebreak-style"</span>: [</div><div class="line">			<span class="string">"warn"</span>,</div><div class="line">			<span class="string">"windows"</span></div><div class="line">		],</div><div class="line">		<span class="string">"quotes"</span>: [</div><div class="line">			<span class="string">"error"</span>,</div><div class="line">			<span class="string">"single"</span></div><div class="line">		],</div><div class="line">		<span class="string">"semi"</span>: [</div><div class="line">			<span class="string">"error"</span>,</div><div class="line">			<span class="string">"always"</span></div><div class="line">		]</div><div class="line">	&#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>We have made few changes after auto generating the config file.</p>
<ul>
<li>We are using the babel-eslint parser instead of eslint default parser.</li>
<li>We have added eslint rules from Airbnb guidelines using the extends configuration.</li>
<li>Changed indent and linebreak-style rules to warn instead of error and changed indent to 2 instead of 4 spaces.</li>
<li>Added rule for comma-dangle to override Airbnb guidelines and revert to eslint recommended guidelines.</li>
</ul>
<p><strong>Terminal to add Sublime eslint package</strong></p>
<h3 id="Eslint-command-line-interface"><a href="#Eslint-command-line-interface" class="headerlink" title="Eslint command line interface"></a>Eslint command line interface</h3><p>We will create three commands for three types of result formats.<br>For default stylish results elint can be used, for tabular format elinttable command, and for using eslint-friendly-formatter we can use the elintsummary command.<br><strong>lint command in package.json</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="string">"elint"</span>: <span class="string">"eslint . --ext .js --ext .jsx --cache || true"</span>,</div><div class="line"><span class="string">"elinttable"</span>: <span class="string">"eslint . --ext .js --ext .jsx --cache --format table ||true"</span>,</div><div class="line"><span class="string">"elintsummary"</span>: <span class="string">"eslint . --ext .js --ext .jsx --cache --format 'node_modules/eslint-friendly-formatter' || true"</span>,</div></pre></td></tr></table></figure></p>
<p>Add .eslintignore to determine folders and files to be ignored by eslint tool.<br><strong>.eslintignore</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># /node_modules and /bower_components ignored by default</span></div><div class="line"><span class="comment"># ignore vendor js files</span></div><div class="line">app/public/js/*.js</div><div class="line"><span class="comment"># ignore build files</span></div><div class="line">build/</div></pre></td></tr></table></figure></p>
<h3 id="StyleLint-for-CSS"><a href="#StyleLint-for-CSS" class="headerlink" title="StyleLint for CSS"></a>StyleLint for CSS</h3><p><strong>StyleLint dependencies</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev stylelint</div><div class="line">npm install --save-dev stylelint-config-standard</div><div class="line">npm install --save-dev stylelint-webpack-plugin</div></pre></td></tr></table></figure></p>
<ul>
<li>stylelint - The core library offering lint rules processing and issue reporting for CSS.</li>
<li>stylelint-config-standard - The standard shareable config for stylelint. Derived from the rules found within: The Idiomatic CSS Principles, Github’s PrimerCSS Guidelines, Google’s CSS Style Guide, Airbnb’s Styleguide, and @mdo’s Code Guide.</li>
<li>stylelint-webpack-plugin - As the name suggest a StyleLint plugin for Webpack. Benefits over stylelint-loader alternative include processing @imports and partials and simpler Webpack setup.<br><strong>.stylelintrc StyleLint configuration</strong><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">	<span class="string">"extends"</span>: <span class="string">"stylelint-config-standard"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="StyleLint-CLI"><a href="#StyleLint-CLI" class="headerlink" title="StyleLint CLI"></a>StyleLint CLI</h3><p><strong>package.json StyleLint command line script</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"slint"</span>: <span class="string">"stylelint ./app/styles/**/*.css ./app/style.css --syntax scss || true"</span></div></pre></td></tr></table></figure></p>
<h3 id="Mocha-Chai-Behavior-Driven-Development"><a href="#Mocha-Chai-Behavior-Driven-Development" class="headerlink" title="Mocha Chai Behavior-Driven Development"></a>Mocha Chai Behavior-Driven Development</h3><p>BDD describes functionality of our app in the form of descriptive statements informing what the app is expected to do in certain conditions.<br><strong>Install mocha and chai</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev mocha</div><div class="line">npm install --save-dev chai</div></pre></td></tr></table></figure></p>
<p>Passing arrow functions to Mocha is discouraged. Their lexical binding of the this value makes them unable to access the Mocha context, and statements like this.timeout(1000) will not work inside an arrow function.</p>
<h3 id="Enzyme-React-component-testing"><a href="#Enzyme-React-component-testing" class="headerlink" title="Enzyme React component testing"></a>Enzyme React component testing</h3><p>Enzyme implements three strategies for testing React components. Enzyme plays well with Mocha, can be extended using custom Chai assertions and convenience functions, and use JSDOM JavaScript headless browser for creating a realistic testing environment.<br><strong>Shallow Rendering.</strong> When you want to constrain your testing to a single component and avoid traversing its child tree.<br><strong>Full DOM Rendering.</strong> When you want to test your React code interactions with the DOM APIs or where your React code uses the lifecycle methods.<br><strong>Static Rendering.</strong> When you want to analyze the results of static HTML that your React components render.<br><strong>Install Enzyme with dependencies</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev enzyme</div><div class="line">npm install --save-dev react-addons-test-utils</div><div class="line">npm install --save-dev jsdom</div><div class="line">npm install --save-dev babel-preset-airbnb</div></pre></td></tr></table></figure></p>
<p><strong>.babelrc config adds airbnb preset during test</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">	<span class="string">"presets"</span>: [<span class="string">"react"</span>, <span class="string">"es2015"</span>, <span class="string">"airbnb"</span>],</div><div class="line">	<span class="string">"env"</span>: &#123;</div><div class="line">		<span class="string">"development"</span>: &#123;</div><div class="line">			<span class="string">"presets"</span>: [<span class="string">"react-hmre"</span>]</div><div class="line">		&#125;</div><div class="line">	&#125;,</div><div class="line">	<span class="string">"plugins"</span>: [</div><div class="line">		<span class="string">"transform-class-properties"</span></div><div class="line">	]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>For using JSDOM, Enzyme recommends loading a document into the global scope before requiring React for the first time.<br>It is very important that the below script gets run before React’s code is run.<br><strong>test/helpers/browser.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> jsdom = <span class="built_in">require</span>(<span class="string">'jsdom'</span>).jsdom;</div><div class="line"></div><div class="line"><span class="keyword">const</span> exposedProperties = [<span class="string">'window'</span>, <span class="string">'navigator'</span>, <span class="string">'document'</span>];</div><div class="line"></div><div class="line">global.document = jsdom(<span class="string">''</span>);</div><div class="line">global.window = <span class="built_in">document</span>.defaultView;</div><div class="line"><span class="built_in">Object</span>.keys(<span class="built_in">document</span>.defaultView).forEach((property) =&gt; &#123;</div><div class="line">	<span class="keyword">if</span> (<span class="keyword">typeof</span> global[property] === <span class="string">'undefined'</span>) &#123;</div><div class="line">		exposedProperties.push(property);</div><div class="line">		global[property] = <span class="built_in">document</span>.defaultView[property];</div><div class="line">	&#125;</div><div class="line">&#125;);</div><div class="line">global.navigator = &#123;</div><div class="line">	userAgent: <span class="string">'node.js'</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><strong>package.json test script</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"test"</span>: <span class="string">"NODE_ENV=test mocha test/helpers/browser.js test/**/*.spec.js --compilers js:babel-core/register --recursive || true"</span></div></pre></td></tr></table></figure></p>

      
    </div>
    
    
      <footer class="article-footer">
        
      </footer>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/07/15/Working-with-Google-Map-API-on-Reactjs/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-title"><span>&lt;</span>&nbsp;
        
          Working with Google Map API on Reactjs
        
      </div>
    </a>
  
  
    <a href="/2016/06/15/How-to-use-this-in-JavaScript/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">How to use this in JavaScript&nbsp;<span>&gt;</span></div>
    </a>
  
</nav>

  
</article>




<div class="share_addthis">
  <div class="sharing addthis_toolbox share">
    <a class="addthis_button_facebook_like"></a>
    <a class="addthis_button_tweet"></a>
    <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-560c64c35486b3d4" async="async"></script>
</div>





</section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Xiufeng Chen&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
  </div>
</body>
</html>