<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Learning Reactjs · Xiufeng</title><meta name="description" content="Learning Reactjs - Xiufeng Chen"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sonnieme" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/XiufengChen" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Learning Reactjs</h1><div class="post-info">Jun 14, 2016</div><div class="post-content"><h1 id="Cheatsheet-for-props-state-events"><a href="#Cheatsheet-for-props-state-events" class="headerlink" title="Cheatsheet for props, state, events"></a>Cheatsheet for props, state, events</h1><p><strong>Properties:</strong> Passing input data from Root/Owner component to Child. Owner defines a property=value which is used within rendered component. The “Owner-ownee” relationship can exist without property passing, as in owner simply rendering a component.<br>Owner component passing property:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;Hello greet=&#123; <span class="keyword">this</span>.state.currentGreeting &#125; message=<span class="string">"World!"</span> /&gt;</div></pre></td></tr></table></figure></p>
<p><strong>State:</strong> Defined within component whose state changes. State change updates rendered markup. Components can be stateless. Treat this.state as immutable. Do not change its value directly. Use setState method instead.<br>Default state:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">this</span>.state = &#123;</div><div class="line">	currentGreeting: props.greet</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><strong>Event Handlers:</strong> Bind, define, UI association within event generating component. Components can exist with no events defined.<br>Event function definition:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">slangGreet() &#123;</div><div class="line">	<span class="keyword">this</span>.setState(&#123;currentGreeting: <span class="string">'Yo!'</span>&#125;);</div><div class="line">&#125;</div><div class="line">hindiGreet() &#123;</div><div class="line">	<span class="keyword">this</span>.setState(&#123;currentGreeting: <span class="string">'Namaste'</span>&#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Associate event functions with UI.<br>UI association with event function:<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;a href="#" onClick=&#123; this.slangGreet &#125;&gt;</div><div class="line">	Slang greeting</div><div class="line">&lt;/a&gt; OR &lt;a href="#" onClick=&#123; this.hindiGreet &#125;&gt;</div><div class="line">	Hindi greeting</div><div class="line">&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<h1 id="Define-props-in-class-component"><a href="#Define-props-in-class-component" class="headerlink" title="Define props in class component"></a>Define props in class component</h1><p>Define props value within class component:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> propTypes = &#123;</div><div class="line">	repo: PropTypes.string.isRequired</div><div class="line">&#125;</div><div class="line">CardStack.defaultProps = &#123;</div><div class="line">	messages: [</div><div class="line">		&#123;id: <span class="number">1</span>, txt: <span class="string">'React Speed UI'</span>&#125;,</div><div class="line">		&#123;id: <span class="number">2</span>, txt: <span class="string">'Single Page Apps'</span>&#125;,</div><div class="line">		&#123;id: <span class="number">3</span>, txt: <span class="string">'Responsive Design'</span>&#125;,</div><div class="line">		&#123;id: <span class="number">4</span>, txt: <span class="string">'Customizable Theme'</span>&#125;,</div><div class="line">		&#123;id: <span class="number">5</span>, txt: <span class="string">'Reusable Components'</span>&#125;,</div><div class="line">		&#123;id: <span class="number">6</span>, txt: <span class="string">'Simple Structure'</span>&#125;,</div><div class="line">		&#123;id: <span class="number">7</span>, txt: <span class="string">'Production Optimized'</span>&#125;,</div><div class="line">		&#123;id: <span class="number">8</span>, txt: <span class="string">'State Machine'</span>&#125;,</div><div class="line">		&#123;id: <span class="number">9</span>, txt: <span class="string">'Expressive Syntax'</span>&#125;,</div><div class="line">	],</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Use props in class component:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> messages = <span class="keyword">this</span>.props.messages;</div></pre></td></tr></table></figure></p>
<p>We don’t want to change props’ value, so we use const to declare a variable.</p>
<p>The componentDidMount method is invoked once, only on the client, immediately after the initial rendering occurs. This is the ideal method to integrate other JavaScript frameworks like jQuery and make AJAX requests.</p>
<p>The componentWillUnmount method is invoked immediately before a component is unmounted from the DOM. We can perform any necessary cleanup in this method, such as cleaning up any DOM elements that were created in componentDidMount<br>method.</p>
<p>官方文档上也说的很清楚，建议我们在componentDidMount中添加ajax，因为这是DOM已经完成了初始化的渲染，在componentWillMount中获取也可以，例如上面的例子，换在componentWillMount中获取数据，完全OK的。但是不建议大家这么干，第一个是官方不推荐，另一个因为DOM还没有渲染，这个时候的一些DOM操作就会出错！<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">componentDidMount() &#123;</div><div class="line">	<span class="keyword">const</span> sourceRepo = <span class="string">`https://api.github.com/repos/<span class="subst">$&#123;this.props.repo&#125;</span>`</span>;</div><div class="line">	<span class="keyword">this</span>.serverRequest = $.get(sourceRepo, <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</div><div class="line">		<span class="keyword">this</span>.setState(&#123;</div><div class="line">			full_name: result.full_name,</div><div class="line">			stargazers_count: result.stargazers_count,</div><div class="line">			open_issues: result.open_issues</div><div class="line">		&#125;);</div><div class="line">	&#125;.bind(<span class="keyword">this</span>));</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="Using-props"><a href="#Using-props" class="headerlink" title="Using props"></a>Using props</h3><p>Let’s create the <code>Comment</code> component, which will depend on data passed in from its parent. Data passed in from a parent component is available as a ‘property’ on the child component. These ‘properties’ are accessed through <code>this.props</code>. Using props, we will be able to read the data passed to the <code>Comment</code> from the <code>CommentList</code>, and render some markup:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// tutorial4.js</span></div><div class="line"><span class="keyword">var</span> Comment = React.createClass(&#123;</div><div class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"comment"</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">className</span>=<span class="string">"commentAuthor"</span>&gt;</span></div><div class="line">          &#123;this.props.author&#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line">        &#123;this.props.children&#125;</div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>By surrounding a JavaScript expression in braces inside JSX (as either an attribute or child), you can drop text or React components into the tree. We access named attributes passed to the component as keys on <code>this.props</code> and any nested elements as <code>this.props.children</code>.</p>
<h3 id="Component-Properties"><a href="#Component-Properties" class="headerlink" title="Component Properties"></a>Component Properties</h3><p>Now that we have defined the <code>Comment</code> component, we will want to pass it the author name and comment text. This allows us to reuse the same code for each unique comment. Now let’s add some comments within our <code>CommentList</code>:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// tutorial5.js</span></div><div class="line"><span class="keyword">var</span> CommentList = React.createClass(&#123;</div><div class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"commentList"</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">Comment</span> <span class="attr">author</span>=<span class="string">"Pete Hunt"</span>&gt;</span>This is one comment<span class="tag">&lt;/<span class="name">Comment</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Comment</span> <span class="attr">author</span>=<span class="string">"Jordan Walke"</span>&gt;</span>This is *another* comment<span class="tag">&lt;/<span class="name">Comment</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Note that we have passed some data from the parent <code>CommentList</code> component to the child<code>Comment</code> components. For example, we passed <em>Pete Hunt</em> (via an attribute) and <em>This is one comment</em> (via an XML-like child node) to the first <code>Comment</code>. As noted above, the <code>Comment</code>component will access these ‘properties’ through <code>this.props.author</code>, and<code>this.props.children</code>.</p>
</div></article></div></section><footer><div class="paginator"><a href="/2016/07/07/Learning-Reactjs-2/" class="prev">PREV</a><a href="/2016/05/05/Learning-Angularjs-4/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2016 <a href="http://yoursite.com">Xiufeng Chen</a>, unless otherwise noted.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>